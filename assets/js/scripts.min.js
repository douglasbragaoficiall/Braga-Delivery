jQuery(document).ready(function(e){e(".fdm-count-products").text(e(".my-delivery-cart-items").length),e(".fdm-click-plus").click(function(){var t=parseInt(e(".fmd-item-qty").val())+1;t>0&&e(".fmd-item-qty").val(t)}),e(".fdm-click-minus").click(function(){var t=parseInt(e(".fmd-item-qty").val())-1;t>0&&e(".fmd-item-qty").val(t)}),e(".myd-tel-8").mask("0000-0000"),e(".myd-tel-9").mask("00000-0000"),e(".myd-tel-8-ddd").mask("(00)0000-0000"),e(".myd-tel-9-ddd").mask("(00)00000-0000"),e(".myd-tel-us").mask("(000)000-0000"),e(".myd-tel-ven").mask("(0000)000-0000"),e("#input-payment-change").maskMoney({thousands:".",decimal:","}),e(".myd-content-filter__tag").on("click",function(){var t,r;e(".myd-content-filter__tag").removeClass("myd-content-filter__tag--active"),e(this).addClass("myd-content-filter__tag--active"),t="fdm-"+e(this).data("anchor"),r=e("#"+t),e("html,body").animate({scrollTop:r.offset().top-80},"slow")}),e(".fdm-orders-loop").on("click",".fdm-orders-items",function(){e(".fdm-orders-items").removeClass("fdm-active"),e(this).addClass("fdm-active"),e(".fdm-btn-order-action").attr("data-manage-order-id",e(this).attr("id")),e(".fdm-orders-full-items").hide(),768>=e(window).width()&&e(".fdm-orders-full-details").show(),e("#content-"+e(this).attr("id")).show()}),e(".fdm-input-filter").on("keyup",function(){var t=e(this).val().toLowerCase();e(".fdm-orders-items").filter(function(){e(this).toggle(e(this).text().toLowerCase().indexOf(t)>-1)})}),e(".fdm-btn-order-action-back").on("click",function(){e(".fdm-orders-full-details").hide()}),e("#input-delivery-zipcode").keypress(function(e){if(8!=e.which&&0!=e.which&&(e.which<48||e.which>57))return!1}),window.secondsRemaining=0,window.intervalHandle=null,window.tick=()=>{var e=document.getElementById("time"),t=Math.floor(secondsRemaining/60),r=secondsRemaining-60*t;r<10&&(r="0"+r);var o=t.toString()+":"+r;e.innerHTML=o,0===secondsRemaining&&clearInterval(intervalHandle),secondsRemaining--},window.countdown=(e=5)=>{if(isNaN(e)){alert("Please enter a number");return}secondsRemaining=60*e,intervalHandle=setInterval(tick,1e3)},window.mercadopago=new MercadoPago(window.ajax_object.mp_public,{locale:"pt-BR"}),window.bricksBuilder=window.mercadopago.bricks(),window.interval=null,window.copiar=()=>{var t=e("<input>");e("body").append(t);var r=e("#copia_cola").val();t.val(r).select(),document.execCommand("copy"),t.remove(),window.Toast.fire({icon:"success",title:"C\xf3digo PIX copiado."})},jQuery("#qr_code").hide(),jQuery("#expirado").hide(),window.waitPix=t=>{window.paymentBrickController.unmount(),e("#input-payment").hide(),e(".qr_code").html(`<img src="data:image/png; base64, ${t.point.qr_code_base64}" alt="Pagar no PIX" height="250" width="250" />`),e("#copia_cola").val(t.point.qr_code),window.countdown(ajax_object.tempo_expiracao),e("#qr_code").slideDown("fast"),window.interval=setInterval(()=>window.get_pix_status(t.reference),1e3)},window.finishOrderV2=t=>{clearInterval(window.interval),window.interval=null,e("#qr_code").hide(),e("#expirado").hide(),e(".hide-payment").hide();let r=document.getElementById("myd-template-order-loading").innerText;document.querySelector(".myd-cart__button-text").innerHTML=r;let o=document.getElementById("finished-order-number"),a=document.querySelector(".myd-cart__finished-track-order > a"),n=document.querySelector(".myd-cart__finished-whatsapp > a");o.innerText=t.order_id,a.href=t.trackLink,n.href=t.link,clearOrder();let i=document.querySelector(".myd-cart__nav--active");i.classList.remove("myd-cart__nav--active"),document.querySelector("."+i.dataset.tabContent).classList.remove("myd-cart__content--active"),document.querySelector("."+i.dataset.next).classList.add("myd-cart__content--active"),document.querySelector(".myd-cart__button").style.display="none";let d=new CustomEvent("MydOrderComplete",{bubbles:!0,cancelable:!0,composed:!1});window.dispatchEvent(d),"yes"==mydStoreInfo.autoRedirect&&(window.location.href=t.link)},window.get_pix_status=t=>{fetch(ajax_object.ajax_url,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:"action=myd_pix_status&reference="+t+"&sec="+ajax_object.order_nonce}).then(t=>{t.ok?t.json().then(t=>{if("approved"===t.status){e("#qr_code").slideUp("fast"),clearInterval(window.interval),window.interval=null,window.finishOrderV2(t);return}"expirou"===t.status&&(e("#qr_code").slideUp("fast"),clearInterval(window.interval),window.interval=null,e("#expirado").slideDown(),window.clearOrder(),window.disable_back=!1)}):console.log("Error")}).catch(e=>console.log(e))},window.Toast=Swal.mixin({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:3e3,target:"#myd-cart",timerProgressBar:!0,didOpen(e){e.addEventListener("mouseenter",Swal.stopTimer),e.addEventListener("mouseleave",Swal.resumeTimer)}}),window.createOrderV2=(t=null)=>{let r=document.getElementById("myd-template-order-loading").innerText;document.querySelector(".myd-cart__button-text").innerHTML=r;var o=e("#input-payment").val();let a=t=>{fetch(ajax_object.ajax_url,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/x-www-form-urlencoded","Cache-Control":"no-cache"},body:"action=myd_pre_order&data="+JSON.stringify(t)+"&sec="+ajax_object.order_nonce}).then(t=>{t.ok?t.json().then(t=>{if(document.querySelector(".myd-cart__button-text").innerHTML="Pr\xf3ximo",t.waitPix){window.disable_back=!0,e(".hide-payment").hide(),e(".myd-cart__button").hide(),waitPix(t);return}if(t?.order_id){window.finishOrderV2(t);return}if(t?.status){window.Toast.fire({icon:"warning",title:"O Banco emissor recusou o pagamento. Verifique os dados do cart\xe3o."});return}window.finishOrderV2(t)}):console.log("Error")}).catch(e=>console.log(e))};if("Pagamento Online"===o){window.paymentBrickController.getFormData().then(({formData:e})=>{if(null===e){document.querySelector(".myd-cart__button-text").innerHTML="Pr\xf3ximo",window.Toast.fire({icon:"warning",title:"Verifique todos os campos e tente novamente."});return}a({formData:e,order:window.getOrder()})});return}a({order:window.getOrder()})},setInterval(()=>{for(var e=document.querySelectorAll('[class^="mp-checkout-bricks__payment-option-"]'),t=0;t<e.length;t++)e[t].querySelector('input[name="EMAIL"]')&&(e[t].style.display="none")},100),e("#input-payment").on("change",function(t){if("Pagamento Online"!==e(this).val()){window?.paymentBrickController&&window.paymentBrickController.unmount(),e(".myd-cart__button").show();return}let r=window.getOrder();(async t=>{let o={initialization:{amount:r.orderTotal.finalPrice,payer:{firstName:e("#input-customer-name").val(),email:"no-reply@dropestore.com"}},customization:{visual:{hideFormTitle:!0,hidePaymentButton:!0,style:{theme:"bootstrap",customVariables:{inputHorizontalPadding:"none"}}},paymentMethods:{maxInstallments:1}},callbacks:{onReady(){document.getElementById("mercadopago_bricks").style.color="white",document.querySelector(".myd-cart__button-text").innerHTML="Pr\xf3ximo",document.querySelectorAll('[class*="mp-checkout-bricks__payment-form-"]').forEach(function(e){e.style.padding="0"});let e=()=>{setTimeout(function(){document.querySelectorAll('[class^="mp-checkout-bricks__payment-option-"]')?.length>0?jQuery(".myd-cart__button").show():jQuery(".myd-cart__button").hide()},500)};document.querySelectorAll('[class^="mp-checkout-bricks__radio-"]').forEach(t=>{t.addEventListener("click",()=>{e()})}),document.querySelectorAll('[class^="mp-checkout-bricks__selector-"]').forEach(t=>{t.addEventListener("click",()=>{e()})})},onError(e){console.log(e)}}};""!==ajax_object.credito_enabled&&(o.customization.paymentMethods.creditCard="all"),""!==ajax_object.debito_enabled&&(o.customization.paymentMethods.debitCard="all"),""!==ajax_object.pix_enabled&&(o.customization.paymentMethods.bankTransfer="all"),window.paymentBrickController=await bricksBuilder.create("payment","mercadopago_bricks",o)})(window.bricksBuilder)})});